// test_mux4way16.c

#include "../unity/src/unity.h"
#include "../include/plexers/mux4way16.h"
#include "../include/plexers/mux16.h"
#include <stdlib.h>

void setUp(void) {
    // Set up code if needed
}

void tearDown(void) {
    // Tear down code if needed
}

/*
    4-way 16-bit Multiplexor:
    |        a         |        b         |        c         |        d         | sel  |       out        |
    | 0000000000000000 | 0000000000000000 | 0000000000000000 | 0000000000000000 |  00  | 0000000000000000 |
    | 0000000000000000 | 0000000000000000 | 0000000000000000 | 0000000000000000 |  01  | 0000000000000000 |
    | 0000000000000000 | 0000000000000000 | 0000000000000000 | 0000000000000000 |  10  | 0000000000000000 |
    | 0000000000000000 | 0000000000000000 | 0000000000000000 | 0000000000000000 |  11  | 0000000000000000 |
    | 0001001000110100 | 1001100001110110 | 1010101010101010 | 0101010101010101 |  00  | 0001001000110100 |
    | 0001001000110100 | 1001100001110110 | 1010101010101010 | 0101010101010101 |  01  | 1001100001110110 |
    | 0001001000110100 | 1001100001110110 | 1010101010101010 | 0101010101010101 |  10  | 1010101010101010 |
    | 0001001000110100 | 1001100001110110 | 1010101010101010 | 0101010101010101 |  11  | 0101010101010101 |

 */

void test_mux4way16_should_return_0000000000000000_for_0000000000000000_0000000000000000_0000000000000000_0000000000000000_00(void) {
    bit a[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    bit b[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    bit c[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    bit d[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    bit sel[] = {0, 0};
    bit *out = mux4way16(a, b, c, d, sel);
    bit expected[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    TEST_ASSERT_EQUAL_UINT8_ARRAY(expected, out, 16);
    free(out);
}

void test_mux4way16_should_return_0000000000000000_for_0000000000000000_0000000000000000_0000000000000000_0000000000000000_01(void) {
    bit a[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    bit b[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    bit c[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    bit d[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    bit sel[] = {0, 1};
    bit *out = mux4way16(a, b, c, d, sel);
    bit expected[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    TEST_ASSERT_EQUAL_UINT8_ARRAY(expected, out, 16);
    free(out);
}

void test_mux4way16_should_return_0000000000000000_for_0000000000000000_0000000000000000_0000000000000000_0000000000000000_10(void) {
    bit a[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    bit b[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    bit c[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    bit d[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    bit sel[] = {1, 0};
    bit *out = mux4way16(a, b, c, d, sel);
    bit expected[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    TEST_ASSERT_EQUAL_UINT8_ARRAY(expected, out, 16);
    free(out);
}

void test_mux4way16_should_return_0000000000000000_for_0000000000000000_0000000000000000_0000000000000000_0000000000000000_11(void) {
    bit a[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    bit b[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    bit c[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    bit d[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    bit sel[] = {1, 1};
    bit *out = mux4way16(a, b, c, d, sel);
    bit expected[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    TEST_ASSERT_EQUAL_UINT8_ARRAY(expected, out, 16);
    free(out);
}

void test_mux4way16_should_return_0001001000110100_for_0001001000110100_1001100001110110_1010101010101010_0101010101010101_00(void) {
    bit a[] = {0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0};
    bit b[] = {1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0};
    bit c[] = { 1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0};
    bit d[] = { 0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1};
    bit sel[] = {0, 0};
    bit *out = mux4way16(a, b, c, d, sel);
    bit expected[] = {0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0};
    TEST_ASSERT_EQUAL_UINT8_ARRAY(expected, out, 16);
    free(out);
}

void test_mux4way16_should_return_1001100001110110_for_0001001000110100_1001100001110110_1010101010101010_0101010101010101_01(void) {
    bit a[] = {0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0};
    bit b[] = {1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0};
    bit c[] = { 1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0};
    bit d[] = { 0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1};
    bit sel[] = {0, 1};
    bit *out = mux4way16(a, b, c, d, sel);
    bit expected[] = {1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0};
    TEST_ASSERT_EQUAL_UINT8_ARRAY(expected, out, 16);
    free(out);
}

void test_mux4way16_should_return_1010101010101010_for_0001001000110100_1001100001110110_1010101010101010_0101010101010101_10(void) {
    bit a[] = {0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0};
    bit b[] = {1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0};
    bit c[] = { 1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0};
    bit d[] = { 0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1};
    bit sel[] = {1, 0};
    bit *out = mux4way16(a, b, c, d, sel);
    bit expected[] = { 1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0};
    TEST_ASSERT_EQUAL_UINT8_ARRAY(expected, out, 16);
    free(out);
}

void test_mux4way16_should_return_0101010101010101_for_0001001000110100_1001100001110110_1010101010101010_0101010101010101_11(void) {
    bit a[] = {0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0};
    bit b[] = {1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0};
    bit c[] = { 1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0};
    bit d[] = { 0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1};
    bit sel[] = {1, 1};
    bit *out = mux4way16(a, b, c, d, sel);
    bit expected[] = { 0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1};
    TEST_ASSERT_EQUAL_UINT8_ARRAY(expected, out, 16);
    free(out);
}

int main(void) {
    UNITY_BEGIN();
    RUN_TEST(test_mux4way16_should_return_0000000000000000_for_0000000000000000_0000000000000000_0000000000000000_0000000000000000_00);
    RUN_TEST(test_mux4way16_should_return_0000000000000000_for_0000000000000000_0000000000000000_0000000000000000_0000000000000000_01);
    RUN_TEST(test_mux4way16_should_return_0000000000000000_for_0000000000000000_0000000000000000_0000000000000000_0000000000000000_10);
    RUN_TEST(test_mux4way16_should_return_0000000000000000_for_0000000000000000_0000000000000000_0000000000000000_0000000000000000_11);
    RUN_TEST(test_mux4way16_should_return_0001001000110100_for_0001001000110100_1001100001110110_1010101010101010_0101010101010101_00);
    RUN_TEST(test_mux4way16_should_return_1001100001110110_for_0001001000110100_1001100001110110_1010101010101010_0101010101010101_01); // should output b
    RUN_TEST(test_mux4way16_should_return_1010101010101010_for_0001001000110100_1001100001110110_1010101010101010_0101010101010101_10); // should output c
    RUN_TEST(test_mux4way16_should_return_0101010101010101_for_0001001000110100_1001100001110110_1010101010101010_0101010101010101_11);
    return UNITY_END();
}